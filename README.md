# Face Emotion Recogition Model

Классификация эмоции с использованием Valence-Arousal регрессии

Модель определяет эмоцию человека по кадрам получаемых с камеры
Имется два варианта получения результата

- Класическая классификация

        Выводит класс эмоции, используется простая модель классификации картинки

- Valence-Arousal регрессия

        Выводит координаты эмоции из пространства Valence-Arousal, 
        которое делит эмоции на положительные и отрицательные, и яркие-спокойные. Такая модель позволяет определять более сложные эмоции за счет регрессионного подхода

Модель определяет 9 эмоции

    anger
    contempt
    disgust
    fear
    happy
    neutral
    sad
    surprise
    uncertain

Использованы библиотеки и фреймворки

    Pandas
    Numpy
    Mediapipe
    OpenCV
    SciPy
    Tensorflow
    ONNX

Установка необходимых пакетов

    pip install -r requirements.txt

Запустить скрипт можно с помощью файла

    start_service.bat

При запуске модель запрашивает вариант определния эмоции

    class - для определения моции путем классификации изображений
    va - для определения координат эмоции

Для более точной работы необходимо, чтобы лицо было на определнном расстоянии от камеры. Оптимальное расстояние на кадре определяется зеленым квадратом вокруг лица

Используемые изображения для тренировки и валидации находятся в архиве

    [train_test_imgs.zip](https://drive.google.com/file/d/1vv51jZucP3ehw1x3fxQ-uoRZKFcloC5K/view?usp=sharing)

Ноутбуки с подготовкой изображений и обучением моделей находятся в папке

    train_model

Предобученные веса для модели должны быть в формате .h5 и находиться рядом со скриптом в папке /weights

    /weights/model_class_weights.h5
    /weights/model_va_weights.h5
